<!DOCTYPE html>
<html lang="fa">
<head>
  <meta charset="UTF-8">
  <title>پخش لیستی ویدیو</title>
  <style>
    body {
      margin: 0;
      background: black;
      font-family: sans-serif;
    }

    .video-wrapper {
      width: 100%;
      height: 100vh;
      position: relative;
      overflow: hidden;
    }

    video {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
      pointer-events: none;
      background-color: black;
    }

    .video-overlay {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-image: url('https://via.placeholder.com/1280x720/000000/FFFFFF?text=Preview');
      background-size: cover;
      background-position: center;
      z-index: 1;
    }

    .video-wrapper.playing .video-overlay {
      display: none;
    }
  </style>
</head>
<body>

  <!-- تکرار ویدیو ۵ بار -->
  <div class="video-wrapper" data-loaded="false">
    <div class="video-overlay"></div>
    <video data-src="https://raw.githubusercontent.com/ShopSto/O/main/Gray%20Illustrative%20Restaurant%20Menu.mp4" muted playsinline></video>
  </div>

  <div class="video-wrapper" data-loaded="false">
    <div class="video-overlay"></div>
    <video data-src="https://raw.githubusercontent.com/ShopSto/O/main/Gray%20Illustrative%20Restaurant%20Menu.mp4" muted playsinline></video>
  </div>

  <div class="video-wrapper" data-loaded="false">
    <div class="video-overlay"></div>
    <video data-src="https://raw.githubusercontent.com/ShopSto/O/main/Gray%20Illustrative%20Restaurant%20Menu.mp4" muted playsinline></video>
  </div>

  <div class="video-wrapper" data-loaded="false">
    <div class="video-overlay"></div>
    <video data-src="https://raw.githubusercontent.com/ShopSto/O/main/Gray%20Illustrative%20Restaurant%20Menu.mp4" muted playsinline></video>
  </div>

  <div class="video-wrapper" data-loaded="false">
    <div class="video-overlay"></div>
    <video data-src="https://raw.githubusercontent.com/ShopSto/O/main/Gray%20Illustrative%20Restaurant%20Menu.mp4" muted playsinline></video>
  </div>

  <script>
    const wrappers = document.querySelectorAll('.video-wrapper');

    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        const wrapper = entry.target;
        const video = wrapper.querySelector('video');

        if (entry.isIntersecting && wrapper.dataset.loaded === "false") {
          wrapper.dataset.loaded = "true";

          setTimeout(() => {
            if (isInViewport(wrapper)) {
              video.src = video.dataset.src;
              wrapper.classList.add('playing');
              video.play();

              video.onended = () => {
                video.pause();
                video.currentTime = video.duration;
              };
            }
          }, 2000);
        }
      });
    }, {
      threshold: 0.6
    });

    wrappers.forEach(wrapper => {
      observer.observe(wrapper);
    });

    function isInViewport(el) {
      const rect = el.getBoundingClientRect();
      return (
        rect.top < window.innerHeight &&
        rect.bottom > 0
      );
    }
  </script>

</body>
</html>
